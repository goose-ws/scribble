{% extends "base.html" %}

{% block title %}Prompt Editor{% endblock %}

{% block header_title %}Prompt Editor{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <style>
        .CodeMirror { 
            height: 600px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            margin-bottom: 1rem;
        }
        button { 
            background-color: #007bff; 
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 16px; 
        }
        button:hover { background-color: #0056b3; }
        p.description { color: #666; margin-bottom: 1rem; }
    </style>
{% endblock %}

{% block content %}
    <p class="description">Modify the system instructions (Prompt) sent to the AI for generating session recaps.</p>
    
    <form action="{{ url_for('save_prompt') }}" method="post">
      <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
      <textarea id="prompt-editor" name="prompt_text">{{ prompt_content }}</textarea>
      <button type="submit"><i class="fas fa-save"></i> Save Prompt</button>
    </form>
{% endblock %}

{% block scripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script>
      // Initialize CodeMirror on the textarea element
      CodeMirror.fromTextArea(document.getElementById('prompt-editor'), {
        lineNumbers: true,
        mode: 'text/plain',
        lineWrapping: true
      });
    </script>
{% endblock %}